use vk;
show TABLES;
select * from users limit 100;
select  * from users where created_at > update_at;-- Используем фильтр для поиска дат update более ранних чем дата created
update users set update_at = NOW() where created_at > update_at; -- Запрос на ОБНОВЛЕНИЕ

select * from profiles limit 10;
select  * from profiles where created_at > update_at;-- Используем фильтр для поиска дат update более ранних чем дата created
update profiles set update_at = NOW() where created_at > update_at; -- Запрос на ОБНОВЛЕНИЕ
-- update profiles set gender = '';
-- CREATE temporary table genders (name CHAR(1));
-- insert into genders values ('F'), ('M');
-- select * from genders;
-- select name from genders order BY RAND() limit 1; -- Получить значения пола F и M случайным образом
-- update profiles set gender = (select name from genders order BY RAND() limit 1); -- Запрос на ОБНОВЛЕНИЕ


select * from messages limit 10;
-- select FLOOR (1 + RAND() * 100);
-- update messages set
-- from_user_id = FLOOR (1 + RAND() * 100),
-- to_user_id = FLOOR (1 + RAND() * 100);
-- select * from messages where from_user_id = to_user_id;
-- update messages set to_user_id = to_user_id + 1 where from_user_id = to_user_id;


select * from media limit 20;
-- update media set
-- user_id = FLOOR (1 + RAND() * 100);

-- СТОЛБЕЦ filename 
-- Где взять расширение? 
-- http://dropbox.com/vk/filename.ext Прописываем путь: имяфайлаИЗтаблицы.случайное расширение
CREATE temporary table extensions (name VARCHAR(10)); -- Создаем временную таблицу
insert into extensions values ('mp4'), ('mp3'), ('png'), ('avi');
select * from extensions;-- Временная таблица расширений создана
-- Компануем основной запрос 
update media  set filename = concat(
-- Функция concat(объеденяет все свои параметры, перечисленные через запятую в ОДНУ строку)
'http://dropbox.com/vk/',
filename,
'.',
(select name from extensions order BY RAND() limit 1))-- строка расширения
;

-- СТОЛБЕЦ size
-- update media set size = FLOOR (1000 + RAND() * 1000000000 where sise < 10000);


-- Должно получиться что-то вроде: '{"ouner": "Ferst Last"}', т.е. '{"КЛЮЧ": "ЗНАЧЕНИЕ -Имя Фамилия"}'
update media set metadata = CONCAT(
'{"ouner": "',
(select CONCAT(first_name, ' ', last_name) 
from users where users.id = media.user_id),
'"}'
);
select * from media limit 20;
-- Просмотрим структуру таблицы, 
desc media;
alter table media modify COLUMN metadata JSON;

-- Таблица media_types, СТОЛБЕЦ media_types_id
select * from media_types;
delete from media_types;
insert into media_types (name) values
('image'),
('audio'),
('video');
TRUNCATE media_types;
update media set;
media_type_id =FLOOR(1 + RAND() * 3);


-- Таблица frendship
select * from friendship limit 10;
-- update friendship set
-- user_id = FLOOR (1 + RAND() * 100),
-- friend_id = FLOOR (1 + RAND() * 100);
select * from friendshep_statuses;-- Видим 8 статусов. Много! Сделаем, и проименуем три
TRUNCATE friendshep_statuses;
insert into friendshep_statuses (name) values
('Requested'),
('Confirmed'),
('Rejected');
select * from friendship;
update friendship set
friend_status_id = FLOOR(1 + RAND() * 3);
update friendship  SET
confirmed_at = created_at,
created_at = confirmed_at;
-- WHERE user_id = 3 AND friend_id = 7;


-- Таблица Групп (communities)
select * from communities;
-- DELETE from communities where id > 30;


-- Таблица Связи (communities_users)
select * from communities_users;
update communities_users set
user_id = FLOOR (1 + RAND() * 100),
communities_id = FLOOR (1 + RAND() * 30);


